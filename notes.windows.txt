
# gitlab - oreplus
SET DEMO_BOOST_ROOT=C:\repos\boost\boost_1_72_0
SET DEMO_BOOST_LIB=C:\repos\boost\boost_1_72_0\lib64-msvc-14.2
SET DEMO_SWIG_DIR=C:\repos\swigwin\swigwin-4.1.1
SET DEMO_ORE_DIR=C:\repos\oreplus\ore
SET DEMO_ORE_SWIG_DIR=C:\repos\oreswig.gitlab

# gitlab - ore
SET DEMO_BOOST_ROOT=C:\repos\boost\boost_1_72_0
SET DEMO_BOOST_LIB=C:\repos\boost\boost_1_72_0\lib64-msvc-14.2
SET DEMO_SWIG_DIR=C:\repos\swigwin\swigwin-4.1.1
SET DEMO_ORE_DIR=C:\repos\ore.gitlab
SET DEMO_ORE_SWIG_DIR=C:\repos\oreswig.gitlab

# github
SET DEMO_BOOST_ROOT=C:\repos\boost\boost_1_72_0
SET DEMO_BOOST_LIB=C:\repos\boost\boost_1_72_0\lib64-msvc-14.2
SET DEMO_SWIG_DIR=C:\repos\swigwin\swigwin-4.1.1
SET DEMO_ORE_DIR=C:\repos\ore.github
SET DEMO_ORE_SWIG_DIR=C:\repos\oreswig.github

# generate wrapper for oreswig zip file
SET DEMO_BOOST_ROOT=C:\repos\boost\boost_1_72_0
SET DEMO_BOOST_LIB=C:\repos\boost\boost_1_72_0\lib64-msvc-14.2
SET DEMO_SWIG_DIR=C:\repos\swigwin\swigwin-4.1.1
SET DEMO_ORE_DIR=C:\repos\ore.github
SET DEMO_ORE_SWIG_DIR=C:\erik\wheels\zipfiles\oreswig

# ore - configure

cd %DEMO_ORE_DIR%
mkdir build
cd %DEMO_ORE_DIR%\build
SET BOOST_INCLUDEDIR=%DEMO_BOOST_ROOT%
SET BOOST_LIBRARYDIR=%DEMO_BOOST_LIB%
SET ZLIB_ROOT=C:\repos\vcpkg\packages\zlib_x64-windows
*********** fixme disable unneeded parts of build
cmake -DBoost_NO_WARN_NEW_VERSIONS=1 -Wno-dev -G "Visual Studio 17 2022" -A x64 ..
cmake -DBoost_NO_WARN_NEW_VERSIONS=1 -Wno-dev -G "Visual Studio 17 2022" -A x64 .. -DMSVC_LINK_DYNAMIC_RUNTIME=OFF 
cmake -DBoost_NO_WARN_NEW_VERSIONS=1 -Wno-dev -G "Visual Studio 17 2022" -A x64 .. -DORE_BUILD_DOC=OFF -DORE_BUILD_EXAMPLES=OFF -DORE_BUILD_TESTS=OFF -DORE_BUILD_APP=OFF -DQL_BUILD_BENCHMARK=OFF -DQL_BUILD_EXAMPLES=OFF -DQL_BUILD_TEST_SUITE=OFF
-> %DEMO_ORE_DIR%\build\ORE.sln

# ore - build

cd %DEMO_ORE_DIR%\build
cmake --build . --config Release
cmake --build . --config Debug
-> %DEMO_ORE_DIR%\build\OREAnalytics\orea\Release\OREAnalytics-x64-mt.lib

# oreswig - cmake

cd %DEMO_ORE_SWIG_DIR%\OREAnalytics-SWIG\Python
mkdir build
cd %DEMO_ORE_SWIG_DIR%\OREAnalytics-SWIG\Python\build
SET BOOST_INCLUDEDIR=%DEMO_BOOST_ROOT%
SET BOOST_LIBRARYDIR=%DEMO_BOOST_LIB%
SET PATH=%PATH%;%DEMO_SWIG_DIR%
REM SET SWIG_ROOT=%DEMO_SWIG_DIR%
cmake -Wno-dev -G "Visual Studio 17 2022" -A x64 .. -DORE=%DEMO_ORE_DIR%
cmake -Wno-dev -G "Visual Studio 17 2022" -A x64 .. -DORE=%DEMO_ORE_DIR% -DMSVC_LINK_DYNAMIC_RUNTIME=OFF 
cmake --build . --config Release
cmake --build . --config Debug

# use the wrapper

cd %DEMO_ORE_SWIG_DIR%\OREAnalytics-SWIG\Python\Examples

SET PYTHONPATH=%DEMO_ORE_SWIG_DIR%\OREAnalytics-SWIG\Python\build;%DEMO_ORE_SWIG_DIR%\OREAnalytics-SWIG\Python\build\Release
SET PYTHONPATH=%DEMO_ORE_SWIG_DIR%\OREAnalytics-SWIG\Python\build;%DEMO_ORE_SWIG_DIR%\OREAnalytics-SWIG\Python\build\Debug

python swap.py

# oreswig - setup.py

cd %DEMO_ORE_SWIG_DIR%\OREAnalytics-SWIG\Python
SET BOOST_ROOT=%DEMO_BOOST_ROOT%
SET BOOST_LIB=%DEMO_BOOST_LIB%
SET ORE_DIR=%DEMO_ORE_DIR%
SET PATH=%PATH%;%DEMO_SWIG_DIR%
SET ORE_STATIC_RUNTIME=1
python setup.py wrap
python setup.py build
python setup.py test
python -m build --wheel

# use the wrapper

cd %DEMO_ORE_SWIG_DIR%\OREAnalytics-SWIG\Python\Examples
SET PYTHONPATH=%DEMO_ORE_SWIG_DIR%\OREAnalytics-SWIG\Python\build\lib.win-amd64-cpython-310
python swap.py

# use the wheel

cd %DEMO_ORE_SWIG_DIR%\OREAnalytics-SWIG\Python\Examples
python -m venv env1
.\env1\Scripts\activate.bat
pip install %DEMO_ORE_SWIG_DIR%\OREAnalytics-SWIG\Python\dist\osre-1.8.9.1-cp310-cp310-win_amd64.whl
python swap.py
deactivate
rmdir /s /q env1

# GITHUB ACTIONS ('g)

# make the source zip file
:: pip install git-archive-all
cd %DEMO_ORE_DIR%
git-archive-all ore.zip
cd %DEMO_ORE_SWIG_DIR%
git-archive-all oreswig.zip

# run the wrapper
cd C:\erik\wheels\zipfiles\oreswig\OREAnalytics-SWIG\Python
SET BOOST_ROOT=%DEMO_BOOST_ROOT%
SET BOOST_LIB=%DEMO_BOOST_LIB%
SET ORE_DIR=%DEMO_ORE_DIR%
SET PATH=%PATH%;%DEMO_SWIG_DIR%
SET ORE_STATIC_RUNTIME=1
python setup.py wrap

=========
https://test.pypi.org/
=========

# UPLOAD
C:\Users\eric.ehlers\.pypirc
#python -m pip install --upgrade pip
#python -m pip install --upgrade twine
cd C:\erik\projects\wheel\wheels\ore
python -m twine upload --repository testpypi *.whl

# INSTALL
pip install -i https://test.pypi.org/simple/ OREAnalytics-Python==1.8.3.2

=========
https://pypi.org/
=========

# UPLOAD
cd C:\erik\projects\wheel\wheels2
#twine upload -r pypi --sign xxx
twine upload -r pypi xxx

# INSTALL
cd %DEMO_ORE_SWIG_DIR%\OREAnalytics-SWIG\Python\Examples
python -m venv env1
.\env1\Scripts\activate.bat
pip install %DEMO_ORE_SWIG_DIR%\OREAnalytics-SWIG\Python\dist\OREAnalytics_Python-1.8.3.2-cp310-cp310-win_amd64.whl
pip install open-source-risk-engine
python swap.py
deactivate
rmdir /s /q env1

